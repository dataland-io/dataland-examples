moduleId: mysql-sync-example

buildCommand: npm run build

info:
  title: MySQL
  description: Sync a MySQL database into Dataland
  author: Dataland Devs <devs@dataland.io>
  sourceCodeUrl: https://github.com/dataland-io/dataland-builtin-modules
  readmePath: README.md
  iconPath: mysql-icon.svg

parameters:
  - mysql-host
  - mysql-port
  - mysql-user
  - mysql-password
  - mysql-db
  - mysql-table-mapping

# To deploy this module locally, create a .env file in the root of this folder
# with the following contents, and add your values.
# DL_PARAM_MYSQL_HOST=
# DL_PARAM_MYSQL_PORT=
# DL_PARAM_MYSQL_USER=
# DL_PARAM_MYSQL_PASSWORD=
# DL_PARAM_MYSQL_DB=
# DL_PARAM_MYSQL_TABLE_MAPPING=

workers:
  - workerId: mysql-sync
    scriptPath: dist/mysqlSync.bundle.js
    triggers:
      transaction: {}
      cron:
        cronExpression: "0 0 * * * * *"
    env:
      MYSQL_HOST: mysql-host
      MYSQL_PORT: mysql-port
      MYSQL_USER: mysql-user
      MYSQL_PASSWORD: mysql-password
      MYSQL_DB: mysql-db
      MYSQL_TABLE_MAPPING: mysql-table-mapping

tables:
  - tableId: mysql-orders
    tableName: "MySQL Orders"
    autoMigrate: true
    columnDescriptors:
      - columnId: order-id
        columnName: order_id
        dataType: float64
        columnAnnotations:
          dataland.io/column-width: "100"
      - columnId: customer-id
        columnName: customer_id
        dataType: string
        columnAnnotations:
          dataland.io/column-width: "120"
      # delivery-status
      - columnId: "delivery-status"
        columnName: delivery_status
        dataType: string
        columnAnnotations:
          dataland.io/column-display-config: |
            {
              "type": "select",
              "options": [
                {
                  "value": "Unable to get delivered",
                  "theme": "ruby"
                },
                {
                  "value": "In warehouse",
                  "theme": "orange"
                },
                {
                  "value": "In transit",
                  "theme": "yellow"
                },
                {
                  "value": "Delivered",
                  "theme": "green"
                }
              ]
            }
      - columnId: "order-placed-at"
        columnName: "order_placed_at"
        dataType: string
        columnAnnotations:
          dataland.io/column-width: "140"
      - columnId: "delivery-time"
        columnName: "delivery_time"
        dataType: float64
        columnAnnotations:
          dataland.io/column-width: "140"
      - columnId: "rating"
        columnName: "rating"
        dataType: float64
        columnAnnotations:
          dataland.io/column-width: "120"
      - columnId: "user-rating-comment"
        columnName: "user_rating_comment"
        dataType: string
        columnAnnotations:
          dataland.io/column-width: "200"
      - columnId: "order-value"
        columnName: "order_value"
        dataType: float64
        columnAnnotations:
          dataland.io/column-width: "120"
